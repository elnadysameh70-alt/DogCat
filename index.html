<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DOG & CAT</title>

<style>
body{
  margin:0;
  font-family:Arial;
  direction:rtl;
  background:#f2f2f2;
}

.page{
  display:none;
  min-height:100vh;
  padding:20px;
}

button,input{
  width:100%;
  padding:10px;
  margin:6px 0;
  font-size:16px;
}

.box{
  max-width:360px;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:10px;
}

/* start */
#startPage{
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  background:#111;
  color:#fff;
}
#startBtn{width:200px}

/* top bar */
.top{
  display:flex;
  justify-content:space-between;
  background:#222;
  color:#fff;
  padding:10px;
  border-radius:8px;
}

/* timer */
.timer{
  background:#fff;
  border:2px solid #000;
  padding:10px;
  text-align:center;
  margin:10px 0;
  font-size:18px;
}
</style>
</head>

<body>

<!-- START -->
<div id="startPage" class="page" style="display:flex">
  <h1>DOG & CAT ğŸ¾</h1>
  <button id="startBtn">Ø§Ø¨Ø¯Ø£</button>
</div>

<!-- REGISTER -->
<div id="registerPage" class="page">
  <div class="box">
    <h3>ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h3>
    <input id="rName" placeholder="Ø§Ù„Ø§Ø³Ù…">
    <input id="rPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
    <input id="rPass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    <input id="rPass2" type="password" placeholder="ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    <button onclick="register()">ØªØ³Ø¬ÙŠÙ„</button>
    <button onclick="goLogin()">Ù„Ø¯ÙŠ Ø­Ø³Ø§Ø¨</button>
  </div>
</div>

<!-- LOGIN -->
<div id="loginPage" class="page">
  <div class="box">
    <h3>Ø¯Ø®ÙˆÙ„</h3>
    <input id="lPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
    <input id="lPass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
    <button onclick="goRegister()">ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</button>
  </div>
</div>

<!-- USER -->
<div id="userPage" class="page">
  <div class="top">
    <div id="uName"></div>
    <button onclick="logout()">Ø®Ø±ÙˆØ¬</button>
  </div>

  <div class="box">
    <h4>Ø§Ù„ÙƒØ§Ø±Ù†ÙŠÙ‡</h4>
    <p>ğŸ“ <span id="uPhone"></span></p>
    <p>ğŸ’° Ø§Ù„Ø±ØµÙŠØ¯: <span id="uBalance"></span></p>
  </div>

  <div id="subTimer" class="timer" style="display:none"></div>

  <div class="box">
    <h4>Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</h4>
    <button onclick="subscribe(7)">Ø§Ø´ØªØ±Ø§Ùƒ 7 Ø£ÙŠØ§Ù…</button>
    <button onclick="subscribe(30)">Ø§Ø´ØªØ±Ø§Ùƒ 30 ÙŠÙˆÙ…</button>
    <button onclick="openWithdraw()">Ø³Ø­Ø¨ Ø±ØµÙŠØ¯</button>
  </div>
</div>

<!-- WITHDRAW -->
<div id="withdrawPage" class="page">
  <div class="box">
    <h3>Ø³Ø­Ø¨ Ø±ØµÙŠØ¯</h3>
    <p>Ø±ØµÙŠØ¯Ùƒ: <span id="wBalance"></span></p>
    <input id="wAmount" type="number" placeholder="Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø­Ø¨ (500+)">
    <button onclick="withdraw()">Ø·Ù„Ø¨ Ø³Ø­Ø¨</button>
    <div id="wTimer" class="timer" style="display:none"></div>
    <button onclick="backUser()">Ø±Ø¬ÙˆØ¹</button>
  </div>
</div>

<!-- ADMIN -->
<div id="adminPage" class="page">
  <div class="box">
    <h3>Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</h3>
    <input id="aPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
    <input id="aAmount" type="number" placeholder="Ø¥Ø¶Ø§ÙØ© Ø±ØµÙŠØ¯">
    <button onclick="addBalance()">Ø¥Ø¶Ø§ÙØ©</button>
    <button onclick="logout()">Ø®Ø±ÙˆØ¬</button>
  </div>
</div>

<script>
let users = JSON.parse(localStorage.getItem("users")) || [];
let current = null;
let subInterval=null;
let withdrawInterval=null;

/* navigation */
function hideAll(){
  document.querySelectorAll(".page").forEach(p=>p.style.display="none");
}
startBtn.onclick=()=>{hideAll();registerPage.style.display="block"}
function goLogin(){hideAll();loginPage.style.display="block"}
function goRegister(){hideAll();registerPage.style.display="block"}
function logout(){current=null;hideAll();loginPage.style.display="block"}
function backUser(){hideAll();userPage.style.display="block"}
function openWithdraw(){
  wBalance.textContent=current.balance;
  hideAll();withdrawPage.style.display="block"
}

/* register */
function register(){
  if(rPass.value!==rPass2.value) return alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©");
  if(users.find(u=>u.phone===rPhone.value)) return alert("Ù…ÙˆØ¬ÙˆØ¯");
  users.push({
    name:rName.value,
    phone:rPhone.value,
    pass:rPass.value,
    balance:0,
    subEnd:null,
    lastWithdraw:0
  });
  localStorage.setItem("users",JSON.stringify(users));
  alert("ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„");
  goLogin();
}

/* login */
function login(){
  if(lPhone.value==="000000" && lPass.value==="000000"){
    hideAll();adminPage.style.display="block";return;
  }
  const u=users.find(x=>x.phone===lPhone.value && x.pass===lPass.value);
  if(!u) return alert("Ø®Ø·Ø£");
  current=u;
  showUser();
}

/* user */
function showUser(){
  hideAll();
  userPage.style.display="block";
  uName.textContent=current.name;
  uPhone.textContent=current.phone;
  uBalance.textContent=current.balance;
  if(current.subEnd && Date.now()<current.subEnd) startSubTimer();
}

/* subscribe */
function subscribe(days){
  if(current.subEnd && Date.now()<current.subEnd)
    return alert("Ø§Ø´ØªØ±Ø§Ùƒ Ù†Ø´Ø·");
  if(!confirm("Ø­ÙˆÙ‘Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø«Ù… Ø§Ù†ØªØ¸Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø£Ø¯Ù…Ù†")) return;
  current.subEnd=Date.now()+days*86400000;
  save();
  startSubTimer();
}
function startSubTimer(){
  subTimer.style.display="block";
  clearInterval(subInterval);
  subInterval=setInterval(()=>{
    let d=current.subEnd-Date.now();
    if(d<=0){subTimer.textContent="Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ";return;}
    let h=Math.floor(d/3600000),
        m=Math.floor(d%3600000/60000),
        s=Math.floor(d%60000/1000);
    subTimer.textContent=`${h}:${m}:${s}`;
  },1000);
}

/* withdraw */
function withdraw(){
  let amt=+wAmount.value;
  if(amt<500) return alert("Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ 500");
  if(amt>current.balance) return alert("Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§Ù");
  let now=Date.now();
  if(now-current.lastWithdraw<86400000){
    startWithdrawTimer(current.lastWithdraw+86400000);
    return alert("Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§");
  }
  let fee=amt*0.05;
  current.balance-=amt;
  current.lastWithdraw=now;
  save();
  alert(`Ø³ØªØ³ØªÙ„Ù… ${amt-fee}`);
  startWithdrawTimer(now+86400000);
}
function startWithdrawTimer(end){
  wTimer.style.display="block";
  clearInterval(withdrawInterval);
  withdrawInterval=setInterval(()=>{
    let d=end-Date.now();
    if(d<=0){wTimer.style.display="none";return;}
    let h=Math.floor(d/3600000),
        m=Math.floor(d%3600000/60000),
        s=Math.floor(d%60000/1000);
    wTimer.textContent=`${h}:${m}:${s}`;
  },1000);
}

/* admin */
function addBalance(){
  let u=users.find(x=>x.phone===aPhone.value);
  if(!u) return alert("ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");
  u.balance+=+aAmount.value;
  save();
  alert("ØªÙ…");
}

/* save */
function save(){
  users=users.map(u=>u.phone===current.phone?current:u);
  localStorage.setItem("users",JSON.stringify(users));
}
</script>

</body>
</html>